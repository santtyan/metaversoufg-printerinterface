#!/usr/bin/env python3
"""Testes rÃ¡pidos para Printer Discovery"""

import asyncio
import time
from printer_discovery_refactored import PrinterDiscovery, discover_printers_sync

def test_basic():
    """Teste bÃ¡sico funcionamento"""
    print("ğŸ§ª Teste BÃ¡sico")
    print("-" * 30)
    
    # Test localhost
    printers = discover_printers_sync("127.0.0.1")
    print(f"âœ“ Localhost test: {len(printers)} impressoras")
    
    # Test class
    discovery = PrinterDiscovery()
    print(f"âœ“ Classe OK: {discovery.KNOWN_PORTS}")
    print()

async def test_performance():
    """Teste performance"""
    print("âš¡ Teste Performance")
    print("-" * 30)
    
    discovery = PrinterDiscovery()
    
    # Test range pequeno
    start = time.time()
    printers = await discovery.discover_network_printers("127.0.0.1")
    elapsed = time.time() - start
    
    print(f"âœ“ Single IP scan: {elapsed:.2f}s")
    print(f"âœ“ Encontradas: {len(printers)} impressoras")
    print()

def test_parsing():
    """Teste parsing rede"""
    print("ğŸŒ Teste Parsing")
    print("-" * 30)
    
    discovery = PrinterDiscovery()
    
    async def run_test():
        # Test CIDR
        hosts = await discovery._ping_sweep("192.168.1.0/24")
        print(f"âœ“ CIDR â†’ {len(hosts)} hosts")
        
        # Test single
        hosts = await discovery._ping_sweep("8.8.8.8")
        print(f"âœ“ Single IP â†’ {hosts}")
    
    asyncio.run(run_test())
    print()

async def run_tests():
    """Executa testes principais"""
    print("=" * 50)
    print("ğŸ§ª PRINTER DISCOVERY TESTS")
    print("=" * 50)
    print()
    
    test_basic()
    test_parsing() 
    await test_performance()
    
    print("=" * 50)
    print("âœ… TESTES CONCLUÃDOS")
    print("=" * 50)
    print()
    print("ğŸ’¡ Uso no projeto:")
    print("from printer_discovery_refactored import discover_printers_sync")
    print("printers = discover_printers_sync('192.168.20.0/24')")

if __name__ == "__main__":
    asyncio.run(run_tests())